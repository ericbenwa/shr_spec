Grammar:		DataElement 5.0
Namespace:		oncocore
Description:	"SHR implementation of ASCO requirements."
Uses:  			shr.core, shr.base, shr.entity

CodeSystem:     SCT = http://snomed.info/sct
CodeSystem:     LNC = http://loinc.org
CodeSystem:		MTH = http://ncimeta.nci.nih.gov
CodeSystem:     UCUM = http://unitsofmeasure.org


EntryElement:   CancerDisorderPresent
Based on:		ConditionPresentAssertion
Description:    "The presence of malignant neoplastic disease, in which abnormal cells divide without control and can invade nearby tissues."
Concept:        SCT#363346000 "Malignant neoplastic disease (disorder)"
                FindingTopicCode from CancerDisorderVS
                StageInformation.StageSummary from http://loinc.org/vs/LL240-3   // MK - also include stage group here
  	            StageInformation.StageDetail value is type CancerStagePanel  
//    0..1 MorphologyBehavior from MorphologyBehaviorVS     //Not carried over from BrCa because it was intended to break out behavior codes from ICD-O-3, and we are no longer using it.


EntryElement:   CancerHistologicType
// did not use precoordinated codes because only available for clinical and pathologic.
Based on:       SimpleCodedNonLaboratoryObservation // MK: Would this use a specimen? If so, it has to be a laboratory observation
Description:    "Classification of the cancer by the type of tissue in which the cancer originates. (Source: NCI)"
Concept:        SCT#371441004 "Histologic type (observable entity)"  // TODO: LOINC number for Cancer Histology (SNOMED) whose title and related code goes to a value set containing descendants of known cancer morphology codes."
                FindingResult from CancerHistologicTypeVS
                FindingTopicCode is SCT#371441004 "Histologic type (observable entity)"
                SpecificFocusOfFinding value is type ref(CancerDisorderPresent)
0..0			AnatomicalLocation
0..0            Device


EntryElement:   CancerHistologicGrade
// did not use precoordinated codes because only available for clinical and pathologic.
Based on:       CodedLaboratoryObservation
Description:    "A description of a tumor based on how abnormal the cancer cells and tissue look under a microscope and how quickly the cancer cells are likely to grow and spread. Low-grade cancer cells look more like normal cells and tend to grow and spread more slowly than high-grade cancer cells. (Source: NCI Dictionary of Cancer Terms)"
Concept:        LNC#21858-6 "Grade Cancer"
                FindingResult from http://loinc.org/vs/LL213-0
                FindingTopicCode is LNC#21858-6 "Grade Cancer"
                SpecificFocusOfFinding value is type ref(CancerDisorderPresent)
0..0			AnatomicalLocation
0..0            Device


EntryElement:   CancerProgression
Based on:       CodedNonLaboratoryObservation
Description:    "The course of a disease, such as cancer, as it becomes worse or spreads in the body. (source: NCI Dictionary)"
Concept:        SCT#246453008 "Course of illness (attribute)"
                FindingResult from CancerProgressionVS
                FindingTopicCode is SCT#246453008 "Course of illness (attribute)"
                SpecificFocusOfFinding value is type ref(CancerDisorderPresent)
// CancerProgressionEvidence is not yet part of M-CODE, but I don't see a better way to include it for FluxNotes
0..*            CancerProgressionEvidence
0..0			AnatomicalLocation
0..0            Device	

		Element:		CancerProgressionEvidence
		Description:	"The type of evidence considered in determining disease progression."
		Value:			CodeableConcept from CancerProgressionEvidenceVS	


Abstract Element:   CancerStagePanel
Based on:       Observation
Description:    "Cancer staging is a way of describing the size of a cancer and whether it has spread into nearby lymph nodes or to other parts of the body. This abstract class is the parent of panels containing information related to clinical and pathologic staging."
Concept:        SCT#258232002 "Cancer staging (tumor staging)"
                SpecificFocusOfFinding value is type ref(CancerDisorderPresent)
    0..1        FindingMethod from TNMTumorStagingSystemVS if covered
    0..0        FindingResult  // true panel
    0..0        NonIndependentFinding
    0..0        ExceptionValue
    0..0        ReferenceRange
    0..0		AnatomicalLocation
    0..0        Specimen
    0..0        Device
    0..0        FindingMethod // The expectation is that each member of the panel will declares its own method; if added here, it would be redundant.


EntryElement:   TNMClinicalStagePanel
Based on:       CancerStagePanel
Concept:        SCT#385349001   "Clinical stage (observable entity)"
Description:    "Clinical staging is performed prior to surgery, based on evidence such as physical examination, imaging, and/or biopsy."
                FindingTopicCode is SCT#385349001 "Clinical stage (observable entity)"
                PanelMembers.Observation
                    includes  0..1 TNMClinicalStageGroup
                    includes  0..1 TNMClinicalPrimaryTumorClassification
                    includes  0..1 TNMClinicalRegionalNodesClassification
                    includes  0..1 TNMClinicalDistantMetastasesClassification

EntryElement:   TNMPathologicStagePanel
Based on:       CancerStagePanel
Concept:        SCT#405978005   "Pathologic stage (observable entity)"
Description:    "Pathologic stage is based on examination of tissue samples removed during surgery, in addition to physical examination and imaging."
                FindingTopicCode is SCT#405978005   "Pathologic stage (observable entity)"
                PanelMembers.Observation
                    includes  0..1 TNMPathologicStageGroup
                    includes  0..1 TNMPathologicPrimaryTumorClassification
                    includes  0..1 TNMPathologicRegionalNodesClassification
                    includes  0..1 TNMPathologicDistantMetastasesClassification


Element:        CancerStageTiming 
Concept:        SCT#260869008 "Timing of stage"
Description:	"Indicates when the staging was done, in terms of treatment landmarks."
Value:          CodeableConcept from StageTimingPrefixVS


Abstract Element: TNMStageGroup
Based on:       CodedNonLaboratoryObservation
Concept:        MTH#C1302362 "Stage Grouping"
Description:    "The classification resulting from cancer staging. Each type of cancer has its own Each type of cancer has its own stage groups based on where the cancer has grown and spread. There are either four or five stage groups per cancer. (Source: NCCN Cancer Staging Guide)"
                FindingResult from http://loinc.org/vs/LL240-3
                FindingTopicCode is MTH#C1302362 "Stage Grouping"
0..1            FindingMethod from TNMTumorStagingSystemVS if covered
                SpecificFocusOfFinding value is type ref(CancerDisorderPresent)
1..1            CancerStageTiming
0..0			AnatomicalLocation
0..0            NonIndependentFinding
0..0            PanelMembers
0..0            Device

        EntryElement:   TNMClinicalStageGroup
        Based on:       TNMStageGroup
        Concept:        TBD
        Description:    "TBD"
                        CancerStageTiming is SCT#385349001   "Clinical stage (observable entity)"

        EntryElement:   TNMPathologicStageGroup
        Based on:       TNMStageGroup
        Concept:        TBD
        Description:    "TBD"
                        CancerStageTiming is SCT#405978005   "Pathologic stage (observable entity)" 
        
Element:        StageSuffix
Concept:	    TBD#TBD	    // TODO: Needs a new LOINC or SNOMED code + value set terms.  assign a local value set until we get something assigned.
Description: "A suffix used in conjuction with certain cancer stage categories, usually qualifying how the category value was determined."
Value:          CodeableConcept from StageSuffixVS  // local value set created 

Abstract Element:   TNMClassification
Based on:		    CodedNonLaboratoryObservation
Concept:		    LNC#21905-5 "Primary tumor.clinical [Class] Cancer"
Description:        "Abstract class parent of TNM stage classifications."
                    SpecificFocusOfFinding value is type ref(CancerDisorderPresent)
1..1                CancerStageTiming
0..1                FindingMethod from TNMTumorStagingSystemVS if covered
0..1                StageSuffix
0..0			    AnatomicalLocation
0..0                NonIndependentFinding
0..0                PanelMembers
0..0                Device

Abstract Element:   TNMClinicalClassification
Based on:           TNMClassification
Concept:            TBD
Description:        "Abstract class parent for TNM clinical stage classifications."
                    CancerStageTiming is SCT#385349001 "Clinical stage (observable entity)"

Abstract Element:   TNMPathologicClassification
Based on:           TNMClassification
Concept:            TBD
Description:        "Abstract class parent for TNM clinical stage classifications."
                    CancerStageTiming is SCT#405978005 "Pathologic stage (observable entity)" 


EntryElement:   TNMClinicalPrimaryTumorClassification
Based on:		TNMClinicalClassification
Concept:		LNC#21905-5 "Primary tumor.clinical [Class] Cancer"
Description:    "Detailed site-specific codes for the clinical tumor (T) as defined by AJCC and recorded by the physician."
                FindingTopicCode is LNC#21905-5 "Primary tumor.clinical [Class] Cancer"
                FindingResult from http://loinc.org/vs/LL237-9 // normative answer list for LNC#21905-5

EntryElement: 	TNMClinicalRegionalNodesClassification
Based on:		TNMClinicalClassification
Concept:		LNC#21906-3 "Regional lymph nodes.clinical [Class] Cancer"
Description:    "" //TODO: pull from LOINC
                FindingTopicCode is LNC#21906-3 "Regional lymph nodes.clinical [Class] Cancer"
                FindingResult from http://loinc.org/vs/LL238-7 // normative answer list for LNC#21906-3

EntryElement:   TNMClinicalDistantMetastasesClassification
Based on:		TNMClinicalClassification
Concept:		LNC#21907-1 "Distant metastases.clinical [Class] Cancer"
Description:    "" //TODO: pull from LOINC
                FindingTopicCode is LNC#21907-1 "Distant metastases.clinical [Class] Cancer"
                FindingResult from http://loinc.org/vs/LL239-5 // normative answer list for LNC#21907-1

EntryElement:   TNMPathologicPrimaryTumorClassification
Based on:		TNMPathologicClassification
Concept:		LNC#21899-0 "Primary tumor.pathology Cancer"
Description:    "TODO: pull from LOINC" //TODO: pull from LOINC
                FindingTopicCode is LNC#21899-0 "Primary tumor.pathology Cancer"
                FindingResult from http://loinc.org/vs/LL232-0 // normative

EntryElement: 	TNMPathologicRegionalNodesClassification
Based on:		TNMPathologicClassification
Concept:		LNC#21900-6 "Regional lymph nodes.pathology [Class] Cancer"
Description:    "TODO: pull from LOINC" //TODO: pull from LOINC
                FindingTopicCode is LNC#21900-6 "Regional lymph nodes.pathology [Class] Cancer"
                FindingResult from http://loinc.org/vs/LL3136-0 // normative

EntryElement:   TNMPathologicDistantMetastasesClassification
Based on:		TNMPathologicClassification
Concept:		LNC#21901-4 "Distant metastases.pathology [Class] Cancer"
Description:    "TODO: pull from LOINC" //TODO: pull from LOINC
                FindingTopicCode is LNC#21901-4 "Distant metastases.pathology [Class] Cancer" // normative
                FindingResult from http://loinc.org/vs/LL3137-8

EntryElement:   TumorPresent
Based on:		BodyStructurePresent
Description:    "The presence of an abnormal mass of tissue (neoplasm) that results when cells divide more than they should or do not die when they should. Tumors may be benign (not cancer), or malignant (cancer). (source: NCI Dictionary)."
Concept:        SCT#395557000 "Tumor finding (finding)"
                FindingTopicCode is SCT#395557000 "Tumor finding (finding)"
                ConditionOrDiagnosisCode from TumorMorphologyVS
0..1            IsPrimaryTumor

        Element:        IsPrimaryTumor
        Concept:        TBD
        Description:    "Whether the tumor is the original or first tumor in the body, for a particular cancer."
        Value:          CodeableConcept from YesNoUnknownVS    // could be boolean but this VS allows for unknown


/**** replaced by Onset of CancerDisorderPresent 
EntryElement:	EarliestDateOfCancerDiagnosis
//TODO_discussion: added, but not convinced we need a separate element for this given the WhenClinicallyRecognized property of ConditionPresentAssertion.
Based on:		SimpleNonLaboratoryObservation
Concept:		LNC#77975-1 "Earliest date of diagnosis"
Description:	"The earliest date of diagnosis (clinical or laboratory) of an illness or condition (Source: LOINC). This element is the same as the WhenClinicallyRecognized property in CancerDiagnosis."
Value:			dateTime // parent class only allows time, dateTime or TimePeriod as choices.
0..0            ReferenceRange
0..0			AnatomicalLocation
                SpecificFocusOfFinding value is type ref(CancerDisorderPresent)
*/

/********** Assessments **************/

EntryElement:   ECOGPerformanceStatus
Based on:       SimpleNonLaboratoryObservation
Description:	"The Eastern Cooperative Oncology Group (ECOG) performance status grade or score, which indicates a patient’s level of daily functioning and physical ability. Source: LOINC"
Concept:        LNC#89247-1 "ECOG Performance Status score"
                FindingResult value is type IntegerQuantity
//0..0            ReferenceRange  // set to 0 to 5
0..0            SpecificFocusOfFinding
0..0			AnatomicalLocation
0..0            Device
                Interpretation from http://loinc.org/vs/LL529-9

EntryElement:   KarnofskyPerformanceStatus
Based on:       SimpleNonLaboratoryObservation
Description:	"The Karnofsky Performance Status (KPS) is a tool used to measure a patient's functional status. It can be used to compare the effectiveness of different therapies and to help assess the prognosis of certain patients, such as those with certain cancers. The KPS score ranges from 0 to 100. Higher scores are associated with better functional status, with 100 representing no symptoms or evidence of disease, and 0 representing death [PMID: 23870327] . This panel contains LOINC terms to report the KPS score [LOINC: 89243-0] and its interpretation [LOINC: 89245-5]."
Concept:        LNC#89243-0 "Karnofsky Performance Status panel"
                FindingResult value is type IntegerQuantity
0..0            SpecificFocusOfFinding
0..0			AnatomicalLocation
0..0            Device
//	            ReferenceRange.Range.LowerBound.Quantity.Number is 0.0
//              ReferenceRange.Range.LowerBound.Quantity.Units is UCUM#1  
//              ReferenceRange.Range.UpperBound.Quantity.Number is 5.0
//              ReferenceRange.Range.UpperBound.Quantity.Units is UCUM#1
0..0            ReferenceRange.ApplicableSubpopulation
0..0            ReferenceRange.ApplicableAgeRange
                Interpretation from http://loinc.org/vs/LL4986-7 // normative answer list



