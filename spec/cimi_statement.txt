Grammar:		DataElement 5.0
Namespace:		cimi.statement
Description:	"The namespace containing cimi-derived classes representing complete clinical statements."
Uses:			shr.core, cimi.element,  cimi.entity, cimi.encounter

CodeSystem:     LNC = http://loinc.org
CodeSystem:     SCT = http://snomed.info/sct
CodeSystem:		MTH = http://ncimeta.nci.nih.gov
CodeSystem:		NCI = https://evs.nci.nih.gov/ftp1/CDISC/SDTM/
CodeSystem:		OBSCAT = http://hl7.org/fhir/observation-category


Element: 		InformationItem
Concept:		MTH#C1705654
Description:	"Parent class for any entry in clinical or administrative health-related system, including information about organizations, providers, patients, services, payments, decision support artifacts, etc."

Element:		Finding
Based on:		InformationItem
Description:	"A determination, opinion, result, or measurement."
0..1			Patient
0..1			Encounter  // findings are often associated with specific encounters
0..1			FindingMethod
//1..1			FindingStatus

		Element:		FindingMethod
		Concept:		TBD
		Description:	"The technique used to create the finding, for example, the specific imaging technical, lab test code, or assessment vehicle."
		Value:			CodeableConcept should be from FindingMethodVS

		Element:		FindingStatus
		Concept:		TBD
		Description:	"Indicates whether the finding is preliminary, amended, final, etc."
		Value:			code from http://hl7.org/fhir/ValueSet/observation-status

//------------- Data Item (aka data element) ------------

Abstract Element:	DataItem
Based on:			Finding
Description:		"A non-separable question-answer pair (data element) consisting of an observable property (represented by a code), value (or exception value), reference range, and interpretation. An observation component represents question-answer pair, and lack sufficient context for full interpretation, e.g., a reference to a patient, problem, or body structure. They do not stand alone, but can be included in observations."
Value:				0..1 (Quantity or CodeableConcept or string or Range or Ratio or time or dateTime or TimePeriod)   
// exclude boolean because component doesn't include it, although Observation does; exclude Media because it is not present in FHIR v4
1..1				ObservableCode   // redundant with Concept
0..1				ExceptionValue from http://hl7.org/fhir/ValueSet/data-absent-reason if covered
0..*				ReferenceRange
//	0..1			Interpretation

		Element:		ObservableCode
		Description:	"A code describing the aspect or property of the subject being observed or measured. The ObservableCode is the 'question code' that pairs to the 'answer' contained in the Value."
		Value:			CodeableConcept

		Element:		ExceptionValue
		Concept:		TBD
		Description:	"Reason that a value associated with a test or other finding is missing."
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/data-absent-reason if covered

		Element:		ReferenceRange
		Concept:		MTH#C0883335
		Description:	"The usual or acceptable range for a test result."
		Value:			Range   // TODO: align this with FHIR
		0..1			Type from http://hl7.org/fhir/ValueSet/referencerange-meaning if covered
		0..1			ApplicableSubpopulation
		0..1			ApplicableAgeRange
		
				Element:	ApplicableSubpopulation
				Concept:	MTH#C0039309 "Target Population"
				Description:	"Codes to indicate the target population this reference range applies to. For example, a reference range may be based on the normal population or a particular sex or race."
				Value: 		CodeableConcept from http://hl7.org/fhir/ValueSet/referencerange-appliesto if covered
		
				Element:	ApplicableAgeRange
				Concept:	TBD
				Description:	"The age at which this reference range is applicable. This is a neonatal age (e.g. number of weeks at term) if the meaning says so."  // FHIR: how exactly does one indicate a neonatal or prenatal age?
				Value:		Range

		Element:		CodedDataItem
		Based on:		DataItem
		Description:	"An data item whose value is a code (concept)."
		Value:			CodeableConcept
		0..0			ReferenceRange 

//-------------Findings------------

EntryElement:	Observation   // TODO: be consistent, or stop using the word "Statement" in class names 
Based on:		DataItem
Concept:		TBD
Description:	"Represents the result of evaluations (measurements, tests, or questions) that have been performed.
Observation has a value representing the result (answer), or an ExceptionValue indicating why the value is not present. The Focus can be the entire patient, or an entity such as a location body structure, intervention, or condition. Things observed about the subject can include social and behavioral factors, subjective and objective observations, and assessments."
0..*			Focus
0..1			RelevantTime
//0..0			Observer
0..1			DeltaFlag
1..*			Category from http://hl7.org/fhir/ValueSet/observation-category if covered
0..1			AnatomicalLocation  // TODO: Change from element to code to align with FHIR??
0..1			AdditionalText	
0..1			Interpretation
0..1			Device
0..1			Specimen
0..*			Precondition
0..*			Media
0..* 			DataItem
0..1			PanelMembers
	
		Element:		Focus
		Description:	"The aspect or attribute of the subject of information that the finding relates to, other than an anatomical location. The Focus is only required if the thing observed is different than the person of record (patient). For example, the subject of observation could be a specific condition if the property is progression, or a specific instance of a wound if the property is wound length."
		Value:			string or CodeableConcept or Identifier or ref(InformationItem)
		0..1			RelationshipToPersonOfRecord

		Element:    	Observer
		Concept:        MTH#C0449416
		Description:    "The person or entity that provided the information in the entry, e.g. the subject (patient), medical professional, family member, device or software program, as distinct from who recorded the entry."
		Value:			ref(InformationItem) //string or ref(Practitioner) or ref(Patient) or ref(Group) or ref(Device) or ref(RelatedPerson) or ref(Organization)  
		0..1			RelationshipToPersonOfRecord

			Element:		RelationshipToPersonOfRecord
			Concept:		MTH#C0015608
			Description: 	"The relationship to the person of record."
			Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/relatedperson-relationshiptype if covered

		Element:		AdditionalText
		Concept: 		MTH#C0947611
		Description:	"A text note containing additional details, explanation, description, comment, or summarization. Details can discuss, support, explain changes to, or dispute information."
		Value:			string  // change to language-text

		Element:		Interpretation
		Concept:		MTH#C0420833
		Description:	"A clinical interpretation of a finding (applies to both assertions and observation)."
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/observation-interpretation if covered

		Element:		RelevantTime
		Concept:		TBD
		Description:	"The time or time period that the finding addresses.
		The clinically relevant time is not necessarily when the information is gathered or when a test is carried out, but for example, when a specimen was collected, or the time period referred to by the question. Use a TimePeriod for a measurement or specimen collection continued over a significant period of time (e.g. 24 hour Urine Sodium)."
		Value:			dateTime or TimePeriod 

		Element:		PanelMembers
		Concept:		TBD
		Description:	"PanelMembers represent the elements of a group of a related but independent evaluations. 
			Examples are the measurements that compose a complete blood count (CBC), or the elements of a pathology report. Each member is an independent evaluation, but the grouping reflects a composite lab order, shared specimen, or a single report author. Typically the Category and Reason are not given for individual findings that are part of the panel, but rather given at the level of the panel itself."
		0..* 			ref(Observation)

		Element:		Precondition
		Concept:		TBD
		Description:	"A description of the conditions or context of an observation, for example, under sedation, fasting or post-exercise. Body position and body site are also qualifiers, but handled separately. A qualifier cannot modify the measurement type; for example, a fasting blood sugar is still a blood sugar. "
		Value:			CodeableConcept or ref(Observation)
			
		Element:		DeltaFlag
		Concept:		MTH#C1705241
		Description:	"Indicator of significant change (delta) from the last or previous measurement."
		Value:			CodeableConcept from DeltaFlagVS
				
//		Element:		Issued
//		Description:	"The date and time this observation was made available to providers, typically after the results have been reviewed and verified."
//		Value:			instant


//  Non-Laboratory Results

EntryElement:	NonLaboratoryObservation
Based on:		Observation
Description:	"An observation not based on a specimen."
0..0			Specimen

EntryElement:	SimpleNonLaboratoryObservation
Based on:		NonLaboratoryObservation
Description:	"An observation having no components or panel members"
0..0			DataItem
0..0			PanelMembers

EntryElement:	CodedNonLaboratoryObservation
Based on:		NonLaboratoryObservation
Concept:		TBD
Description:	"The result of evaluations (measurements, tests, or questions) whose answer is expressed as a code."
Value:			CodeableConcept
0..0			ReferenceRange

EntryElement:	SimpleCodedNonLaboratoryObservation
Based on:		CodedNonLaboratoryObservation
Description:	"An observation whose result is a code, and also having no components or panel members"
0..0			DataItem
0..0			PanelMembers

EntryElement:	ComponentOnlyNonLaboratoryObservation
Based on:		NonLaboratoryObservation
Description:	"An observation with components, but without a result value or panel members."
0..0			Value
0..0			ExceptionValue
0..0			PanelMembers
0..0			ReferenceRange

EntryElement:	Panel
Based on:		Observation
Description:	"An observation with panel members, but without a result value or components."
0..0			Value
0..0			ExceptionValue
0..0			ReferenceRange
0..0			DataItem
1..1			PanelMembers

// Laboratory Measurements and Results

EntryElement:	LaboratoryObservation
Based on:		Observation
Description:	"A coded finding based on a specimen collected from a patient."
1..1			Patient
1..1			Specimen
0..0			AnatomicalLocation  // AnatomicalLocation is determined indirectly from Specimen.CollectionSite
				Category is OBSCAT#laboratory
0..*			DiagnosticService

		Element:		DiagnosticService
		Concept:		TBD
		Description:	"The service completing the observations, e.g. biochemistry, microbiology, blood bank."
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/diagnostic-service-sections if covered

EntryElement:	CodedLaboratoryObservation
Based on:		LaboratoryObservation
Description:	"A coded finding from a laboratory test."
Value:			CodeableConcept
0..0			ReferenceRange

EntryElement:	SimpleLaboratoryObservation
Based on:		LaboratoryObservation
Description:	"A coded finding from a laboratory test without further panel members or components."
0..0			DataItem
0..0			PanelMembers

EntryElement:	SimpleCodedLaboratoryObservation
Based on:		CodedLaboratoryObservation
Description:	"A coded finding from a laboratory test without further panel members or components."
0..0			DataItem
0..0			PanelMembers

//---------- Assertions -------------

Abstract Element:	ExistenceAssertion
Based on:			Finding
Description:		"An assertion that an event has or has not taken place, or a relationship, situation, condition, or other phenomenon is present or absent."
0..*				PartOf
1..1				PresentOrAbsent
1..1				ObjectTypeCode
1..1				VerificationStatus
0..1				ObjectIdentifier
0..1				Certainty

		Element:		PartOf
		Description:	"The larger entity that the asserted item is a portion of. For example, a wound tunnel might be part of a wound; an organization part of a larger organization, or an encounter with a hospitalist might be part of a larger hospitalization encounter."
		Value:			ref(InformationItem)

		Element:		BelongsTo
		Description:	"The person, place, event, condition, other statement that this object belongs to, if other than the patient. For example, a wound tunnel belongs to a wound."
		Value:			ref(InformationItem)

		Element:		PresentOrAbsent	
		Description:	"Whether the object is present or absent, exists or does not exist."
		Value:			CodeableConcept from PresentAbsentVS

		Element:		ObjectTypeCode
		Description: 	"A code representing the type of event, condition, or phenomenon that is being asserted to exist or not exist, for example, the SNOMED-CT code for pneumonia."
		Value:			CodeableConcept

		Element:		VerificationStatus
		Concept:		TBD
		Description:	"Whether an assessment has been confirmed by testing or observation."
		Value:			CodeableConcept	

		Element: 		ObjectIdentifier
		Description:	"For later reference, an identifier for the object implied by the assertion, which allows the object to be tracked over time. For example, a wound number is used to track a specific wound's condition over time."
		Value:			string

		Element:		Certainty
		Concept:		TBD
		Description:	"The degree of confidence in a conclusion or assertion."
		Value:			CodeableConcept

Abstract Element:	PresenceAssertion  // AssertPresence
Based on:			ExistenceAssertion
Description:		"Statement that a finding is present."
					PresentOrAbsent is SCT#52101004 "Present (qualifier value)"			
0..1				Onset
0..1				Abatement
0..1				Certainty from PresenceCertaintyVS

			Element:		Onset
			Concept:		LNC#85585-8
			Description:	"The beginning or first appearance of a mental or physical disorder."
			Value:			dateTime or Age or TimePeriod or Range or string
			
			Element:		Abatement
			Concept:		LNC#88878-4
			Description:	"The end, remission or resolution."
			Value:			dateTime or Age or boolean or TimePeriod or Range or string

Abstract Element:	AbsenceAssertion
Based on:			ExistenceAssertion
Description:		"Statement that an entity, person, role, condition, or phenomenon is absent."
0..1				Certainty from AbsenceCertaintyVS

EntryElement:	ConditionPresenceStatement
Based on:		PresenceAssertion
Concept:		TBD
Description:	"A condition that is or may be present in a subject. 'Condition' is interpreted broadly and could be a disorder, abnormality, problem, injury, complaint, functionality, illness, disease, ailment, sickness, affliction, upset, difficulty, disorder, symptom, worry, or trouble."
//0..0			SourceOfInformation //value is type PatientOrPractitionerOrRelatedPerson
1..1			ObjectTypeCode from http://hl7.org/fhir/us/core/ValueSet/us-core-problem if covered 
1..*			Category from ConditionCategoryVS
0..*			AnatomicalLocation
0..*			ConditionCause
1..1			ClinicalStatus
0..1			WhenClinicallyRecognized
0..1			PresentOnAdmission
0..1			Severity
0..1			Criticality
0..1			Stage

			Element:		ConditionCause
			Description: "The cause of the condition. This includes such causes as disease vectors and endogenous states (e.g., macular degeneration due to diabetes), substances, medications, micro-organisms, and forces associated with the occurrence of a Condition from temporal or causative perspectives"
			Value:			CodeableConcept or ref(Entity) or ref(Finding)
			// probably other attributes needed, such as likelihood or type of cause

			Element:		ClinicalStatus
			Concept:		TBD
			Description:	"A flag indicating whether the condition is active or inactive, recurring, in remission, or resolved (as of the last update of the Condition)."
			Value:			code from http://hl7.org/fhir/ValueSet/condition-clinical

			Element:		WhenClinicallyRecognized
			Concept:		TBD
			Description:	"The time at which a condition or condition was first identified in a healthcare context."
			Value:			date

			Element:		PresentOnAdmission
			Concept:		LNC#89251-3 "Condition present on admission"
			Description:	"If the problem or condition existed before the current episode of care."
			Value:			CodeableConcept from YesNoUnknownVS

			Element:		Severity
			Concept:		MTH#C0392364
			Description:	"Degree of harshness or extent of a symptom, disorder, or condition."
			Value: 			CodeableConcept from http://hl7.org/fhir/ValueSet/condition-severity

			Element:		Criticality
			Concept:		MTH#C3858539 "Criticality"
			Description:	"The potential clinical harm associated with a condition. When the worst case result is assessed to have a life-threatening or organ system threatening potential, it is considered to be of high criticality."
			Value:			code from http://hl7.org/fhir/ValueSet/allergy-intolerance-criticality

			Element:		Stage
			Concept:		MTH#C0699749
			Description:	"The relative advancement in the course of a disease. The value is the summary stage or stage group. StageDetail optionally contains the full staging information."
			Value:			CodeableConcept
			0..1			StageDetail
			
					Element:		StageDetail
					Concept:		TBD
					Description:	"The full staging information"
					Value:			ref(Observation)

			Element:		AlleviatingFactor
			Concept:		LNC#55258-8
			Description:	"Activities that reduce the severity of the pathology"
			Value:			CodeableConcept

			Element:		ExacerbatingFactor
			Concept:		LNC#55258-8
			Description:	"Activities that increase the severity of the pathology"
			Value:			CodeableConcept



EntryElement:	ConditionAbsenceStatement
Based on:		AbsenceAssertion
Concept:		MTH#C0277541  "no disease present"
Description:	"A finding that a condition is or was not present in the subject at a certain time or time period, not necessarily the time the information is gathered."
				ObjectTypeCode from http://hl7.org/fhir/us/core/ValueSet/us-core-problem if covered 
1..*			Category from ConditionCategoryVS
0..*			AnatomicalLocation
				
EntryElement:	ClinicalNote
Based on:		Finding
Concept:		MTH#C0747978 "Progress Note"
Description:	"An entry concerning a patient where the result is a narrative text."
1..1			Patient
1..1			AdditionalText // make required


//---------- Actions --------------

Abstract Element:	ActionStatement
Based on:			InformationItem
Description:		"Abstract class representing any type of action."
1..1				Patient   // constrain from 0..1 to 1..1 
0..1				Encounter // actions often take place during an encounter
1..1				ActionTopic  // introduce topics at this point
0..*				Reason

	Element:		Reason
	Concept:		MTH#C0566251
	Description:	"The justification for an action or non-action, conclusion, opinion, etc."
	Value:			string or CodeableConcept or ref(Finding)

Abstract Element:	ActionPerformedStatement
Based on:			ActionStatement
Description:		"Abstract class representing performance of any type of action."
1..1				OccurrenceTimeOrPeriod  // when the action took place
0..*				Participant		
1..1				Status should be from http://hl7.org/fhir/ValueSet/event-status  
0..1				Method
0..*				RelatedRequest
//0..1				EnactsPlan
//0..1				FulfillsOrder
0..1				ref(Facility)
0..1				Outcome  // e.g., AdverseEvent

		Element:		Participant
		Concept:		MTH#C1550369
		Description:	"An entity (usually a Practitioner, Patient, or Organization but potentially a device or other entity) that participates in a healthcare task or activity."
		Value:			ref(EntityOrRole)
		0..1 			ParticipationType  // role
		0..1			ParticipationPeriod
		0..1			OnBehalfOf
		
			Element:		ParticipationType
			Concept:		MTH#C1553854
			Description:	"The role played by the participant engaged in the action, for example, as the attending physician, surgical assistant, etc."
			Value:			CodeableConcept from FHIR/v3-ParticipationType
			
			Element:		ParticipationPeriod
			Concept:		TBD
			Description:	"The point in time or span of time the participant is involved."
			Value:			TimePeriod
	
		Element:		Method
		Concept:		TBD
		Description:	"The technique used to carry out an action, for example, the specific imaging technical or assessment vehicle."
		Value:			CodeableConcept  // TODO: limit to a procedure code
		
		Element:		RelatedRequest
		Concept:		TBD
		Description:	"The proposal, order, or plan that is partly or wholly fulfilled by the performance of this act."
		Value:			ref(ActionRequestedStatement)  
		
	/*	
		Element:		EnactsPlan
		Concept:		TBD
		Description:	"The plan that is partly or wholly enacted by the performance of this act."
		Value:			ref(ActionRequestedStatement)

		Element:		FulfillsOrder
		Concept:		TBD
		Description:	"The order that is partly or wholly enacted by the performance of this act."
		Value:			ref()
	*/	
		Element:		Outcome
		Concept:		TBD
		Description:	"The result of performing an action or behavior, for example, an adverse reaction or new finding."
		Value:			CodeableConcept could be from http://hl7.org/fhir/ValueSet/procedure-outcome
		0..*			ref(Finding)


Abstract Element:	ActionRequestedStatement
Based on:			ActionStatement
Description:		"Abstract class representing a request for any type of action."
1..1			Status should be from http://hl7.org/fhir/ValueSet/request-status
1..1			RequestIntent
0..1			ExpectedPerformanceTime
0..1			ExpectedPerformerType
0..1			ExpectedPerformer
0..1			ExpectedMethod 
0..1 			PriorityRank should be from http://hl7.org/fhir/ValueSet/request-priority
0..1			PerformerInstructions
0..1			PatientInstructions	
0..1			CommunicationMethod

		Element:		RequestIntent	
		Concept:		TBD
		Description:	"Indicates the level of authority/intentionality associated with the request and where the request fits into the workflow chain."
		Value:			code from http://hl7.org/fhir/ValueSet/request-intent
		
		Element:		ExpectedPerformanceTime
		Concept:		TBD
		Description:	"When an action should be done. If the action is a series or recurs (e.g. daily blood sugar testing in the morning) then a Timing can be used to describe the periodicity."
		Value:			dateTime or date or TimePeriod or Timing

		Element:		ExpectedPerformerType
		Concept:		TBD
		Description:	"What type of party should carry out the testing."
		Value:			CodeableConcept // what ValueSet??

		Element:		ExpectedPerformer
		Concept:		TBD
		Description:	"Who should carry out the tests. For example, the patient or caregiver."
		Value:			ref(Entity) or ref(Organization)
		
		Element:		ExpectedMethod
		Concept:		TBD
		Description:	"The method that should be used to carry out the action."
		Value:			ref(Method)

		Element:		PerformerInstructions
		Concept:		TBD
		Description:	"Information for the performer of the test, if needed."
		Value:			string

		Element:		PatientInstructions
		Concept:		TBD
		Description:	"Information for the patient, such as, where to get the test, how to prepare for the test, etc."
		Value:			string
		
		Element:		CommunicationMethod
		Concept:		TBD
		Description:	"This is the method the provider used to communicate. Examples include: Written, Telephoned, Verbal, Electronically Entered, Policy, Service Correction, Duplicate, etc. 'Code indicating the origin of the prescription.' - NCPDP Telecommunication (Field 419-DJ, Data Dictionary 201104). Possible values include: Written; Telephone; Electronic; Facsimile; Pharmacy; Not Known."
		Value:			CodeableConcept


Abstract Element:	ActionNotPerformedStatement
Based on:			ActionStatement
Description:		"Abstract class representing non-performance of any type of action."
0..1				RelatedRequest 
1..1				NonOccurrenceTimeOrPeriod

Abstract Element:	ActionRequestedAgainstStatement
Based on:			ActionStatement
Description:		"Abstract class representing a request to not perform any type of action."

Abstract Element:	ActionTopic
Description:		"Compositional and reusable grouping of attributes that make up the clinical focus of an action statement, independent whether the action is potential or actual, past or future."
0..1				Category
1..1				TopicCode

		Element:		TopicCode
		Concept:		TBD
		Description:	"The concept representing the finding or action that is the topic of the statement. 
		
		For action topics, the TopicCode represents the action being described. For findings, the TopicCode represents the 'question' or property being investigated. For evaluation result findings, the TopicCode contains a concept for an observable entity, such as systolic blood pressure. For assertion findings, the TopicCode contains a code representing the condition, allergy, or other item being asserted. In all cases, the TopicCode describes the topic  of the action or the finding."
		Value:			CodeableConcept

