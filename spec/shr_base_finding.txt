Grammar:		DataElement 5.0
Namespace:		shr.base
Description:	"Contains the SHR Entry definition -- the metadata added to any independent item in the SHR."
Uses:			shr.core, shr.entity, shr.encounter


Abstract Element:	ObservationComponent
Description:		"A sub-observation contributing to the parent observation, expressed as separate code value pairs that share the same attributes. Examples include systolic and diastolic component observations for blood pressure measurement and multiple component observations for genetics observations. Component observations share the same attributes in the Observation resource as the primary observation and are always treated a part of a single observation (they are not separable). However, the reference range for the primary observation value is not inherited by the component values and is required when appropriate for each component observation."
// should an observation component have additional properties, such as protocol, circumstance, or interpretation?
// how do we handle a normal? (physical exam normal)
// exclusions? (diabetes excluded)
1..1			Code
0..1			DataValue
0..1			DataAbsentReason
0..1			ReferenceRange
0..1			Interpretation

		Element:		DataValue
		Description:	"The value or result of a test, evaluation, or judgment, for example, a systolic blood pressure, or if a condition or body structure is present or absent."
		Value:			CodeableConcept or Quantity or string or Range or Ratio or time or dateTime or TimePeriod
		// exclude boolean because FHIR STU3 component doesn't include it, although Observation does; exclude Media because it is not present in FHIR v4

		Element:		DataAbsentReason
		Concept:		TBD
		Description:	"Reason that a value associated with a test or other finding is missing."
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/data-absent-reason if covered

		Element:		ReferenceRange
		Concept:		MTH#C0883335
		Description:	"The usual or acceptable range for a test result."
		0..1			Range   // TODO: align this with FHIR
		0..1			Type from http://hl7.org/fhir/ValueSet/referencerange-meaning if covered
		0..1			ApplicableSubpopulation
		0..1			ApplicableAgeRange
		
				Element:	ApplicableSubpopulation
				Concept:	MTH#C0039309 "Target Population"
				Description:	"Codes to indicate the target population this reference range applies to. For example, a reference range may be based on the normal population or a particular sex or race."
				Value: 		CodeableConcept from http://hl7.org/fhir/ValueSet/referencerange-appliesto if covered
		
				Element:	ApplicableAgeRange
				Concept:	TBD
				Description:	"The age at which this reference range is applicable. This is a neonatal age (e.g. number of weeks at term) if the meaning says so."  // FHIR: how exactly does one indicate a neonatal or prenatal age?
				Value:		Range

Abstract Element:	CodedObservationComponent
Based on:			ObservationComponent
Description:		"A non-independent finding whose result is a concept code."
					DataValue value is type CodeableConcept
0..0				ReferenceRange					

Abstract Element:	QuantitativeObservationComponent
Based on:			ObservationComponent
Description:		"A non-independent finding whose result is a quantity."
					DataValue value is type Quantity

Abstract Element:	ConditionOrObservation
Based on:		ClinicalStatement
Description:	"An assertion, determination, opinion, evaluation, result, observation, or measurement made by a person or device."
1..1			Code
				StatusOrActive is type Status


EntryElement:	Observation
Based on:		ConditionOrObservation
Concept:		TBD
Description:	"Represents the result of evaluations (measurements, tests, or questions) that have been performed.
Observation has a value representing the result (answer), or an DataAbsentReason indicating why the value is not present. The Focus can be the entire patient, or an entity such as a location body structure, intervention, or condition. Things observed about the subject can include social and behavioral factors, subjective and objective observations, and assessments.
For an Observation, the Code describes the aspect or property of the subject being observed or measured. The Code is the 'question code' that pairs to the 'answer' contained in the Value."
0..1			DataValue
0..1			DataAbsentReason
0..1			Method
0..1			RelevantTime
1..1			Status from http://hl7.org/fhir/ValueSet/observation-status
0..1			Category from http://hl7.org/fhir/ValueSet/observation-category if covered  // MK Category cardinality from 0..* to 0..1 to be compatible with DSTU 2
0..1			Focus
0..1			BodySite
0..1			CommentOrDescription	
0..1			Interpretation
0..1			Device
0..1			ReferenceRange
0..1			Components
0..1			PanelMembers
				Asserter value is type PersonOrOrganization
//0..1			DeltaFlag

		Element:		RelevantTime
		Concept:		TBD
		Description:	"The time or time period that the statement addresses.
		The clinically relevant time is not necessarily when the information is gathered or when a test is carried out, but for example, when a specimen was collected, or the time period referred to by the question. Use a TimePeriod for a measurement or specimen collection continued over a significant period of time (e.g. 24 hour Urine Sodium)."
		Value:			dateTime or TimePeriod 
		Element:		Focus
		Description:	"The entity this condition or observation relates to, for example, a related person. The Focus is only required if the person or thing observed is different than the patient. Focus should not be an anatomical location. Examples: The focus for cancer progression would be the cancer condition; for wound length, an instance of a wound (a condition)."
		Value:			ref(DomainResource) or CodeableConcept // or string or Identifier 

		Element:		Interpretation
		Concept:		MTH#C0420833
		Description:	"A clinical interpretation of a finding (applies to both assertions and observation)."
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/observation-interpretation if covered

		Element:		PanelMembers
		Concept:		TBD
		Description:	"PanelMembers represent the elements of a group of a related but independent evaluations. 
			Examples are the measurements that compose a complete blood count (CBC), or the elements of a pathology report. Each member is an independent evaluation, but the grouping reflects a composite lab order, shared specimen, or a single report author. Typically the Category and Reason are not given for individual findings that are part of the panel, but rather given at the level of the panel itself."
		0..* 			ref(Observation)

		Element:		Components
		Concept:		TBD
		Description:	"Sub-observations that are part of this observation. A sub-observation contributs to the parent observation and are always treated a part of a single observation (they are not separable). However, the reference range for the primary observation value is not inherited by the component values and is required when appropriate for each component observation."
		0..* 			ref(ObservationComponent)


/* commented out but it might need to come back, so please save
		Element:		Precondition
		Concept:		TBD
		Description:	"A description of the conditions or context of an observation, for example, under sedation, fasting or post-exercise. Body position and body site are also qualifiers, but handled separately. A qualifier cannot modify the measurement type; for example, a fasting blood sugar is still a blood sugar. "
		Value:			CodeableConcept or ref(Observation)


		Element:		DeltaFlag
		Concept:		MTH#C1705241
		Description:	"Indicator of significant change (delta) from the last or previous measurement."
		Value:			CodeableConcept from DeltaFlagVS
*/				
//		Element:		Issued
//		Description:	"The date and time this observation was made available to providers, typically after the results have been reviewed and verified."
//		Value:			instant


//  Non-Laboratory Results

EntryElement:	NonLaboratoryObservation
Based on:		Observation
Description:	"An observation not based on a specimen."

EntryElement:	SimpleNonLaboratoryObservation
Based on:		NonLaboratoryObservation
Description:	"An observation having no components or panel members"
0..0			Components
0..0			PanelMembers

EntryElement:	CodedNonLaboratoryObservation
Based on:		NonLaboratoryObservation
Concept:		TBD
Description:	"The result of evaluations (measurements, tests, or questions) whose answer is expressed as a code."
				DataValue value is type CodeableConcept
0..0			ReferenceRange

EntryElement:	SimpleCodedNonLaboratoryObservation
Based on:		CodedNonLaboratoryObservation
Description:	"An observation whose result is a code, and also having no components or panel members"
0..0			Components
0..0			PanelMembers

EntryElement:	ComponentOnlyNonLaboratoryObservation
Based on:		NonLaboratoryObservation
Description:	"An observation with components, but without a result value or panel members."
0..0			DataValue
0..0			DataAbsentReason
0..0			PanelMembers
0..0			ReferenceRange

// Laboratory Measurements and Results

EntryElement:	LaboratoryObservation
Based on:		Observation
Description:	"A coded finding based on a specimen collected from a patient."
				Code from LaboratoryCodeVS if covered
1..1			Category   // MK changed from 1..* to 1..1 to be compatible with DSTU 2
1..1			Patient
0..1			Specimen
0..0			BodySite  // BodySite is determined indirectly from Specimen.CollectionSite
				Category is OBSCAT#laboratory

EntryElement:	CodedLaboratoryObservation
Based on:		LaboratoryObservation
Description:	"A coded result from a laboratory test."
				DataValue value is type CodeableConcept
0..0			ReferenceRange

EntryElement:	SimpleLaboratoryObservation
Based on:		LaboratoryObservation
Description:	"A coded result from a laboratory test without further panel members or components."
0..0			Components
0..0			PanelMembers

EntryElement:	SimpleCodedLaboratoryObservation
Based on:		CodedLaboratoryObservation
Description:	"A coded result from a laboratory test without further panel members or components."
0..0			Components
0..0			PanelMembers

EntryElement:	QuantitativeLaboratoryObservation
Based on:		LaboratoryObservation
Description:	"A quantiative result from a laboratory test."
				DataValue value is type Quantity

EntryElement:   Panel
Based on:       Observation
Description:    "A set of independent but related observations that are often presented together to facilitate interpretation, such as a lipid panel."
0..0            Components
0..0		    BodySite
0..0            Specimen
0..0            Device


EntryElement:	HeadlessPanel
Based on:		Panel
Description:	"A panel that does not have an overall value that summarizes the entire panel."
0..0			DataValue
0..0			DataAbsentReason
0..0            ReferenceRange



EntryElement:	Condition
Based on:		ConditionOrObservation
Description:		"A condition that is or may be present in a subject. 'Condition' is interpreted broadly and could be a disorder, abnormality, problem, injury, complaint, functionality, illness, disease, ailment, sickness, affliction, upset, difficulty, disorder, symptom, worry, or trouble."
				Code from http://hl7.org/fhir/us/core/ValueSet/us-core-problem if covered  // cannot make the binding weaker because US Core requires an extensible binding
				Asserter value is type PatientOrPractitionerOrRelatedPerson
1..1			Patient
1..1			Category from ConditionCategoryVS   // DSTU 2 change - category is 1..1 in Argonaut
0..*			BodySite
1..1			Status from http://hl7.org/fhir/ValueSet/condition-ver-status
1..1			ClinicalStatus from http://hl7.org/fhir/ValueSet/condition-clinical
0..1			Severity from http://hl7.org/fhir/ValueSet/condition-severity
0..1			StageInformation
0..1			Onset
0..1			Abatement
0..1			Evidence
// Stuff from CIMI eliminated
//0..1			WhenClinicallyRecognized
//0..1			PresentOnAdmission
//0..*			ConditionCause
//0..1			Criticality

			Element:		Evidence
			Description:	"Supporting evidence / manifestations that are the basis of the Condition's verification status, such as evidence that confirmed or refuted the condition."
			0..*		Manifestation
			0..*		DomainResource

				Element:	Manifestation
				Description: "Clinical symptoms/signs."
				Value:		CodeableConcept could be from http://hl7.org/fhir/ValueSet/clinical-findings

			Element:		ConditionCause
			Description: "The cause of the condition. This includes such causes as disease vectors and endogenous states (e.g., macular degeneration due to diabetes), substances, medications, micro-organisms, and forces associated with the occurrence of a Condition from temporal or causative perspectives"
			Value:			CodeableConcept or ref(Entity) or ref(ConditionOrObservation)
			// probably other attributes needed, such as likelihood or type of cause

			Element:		ClinicalStatus
			Concept:		TBD
			Description:	"A flag indicating whether the condition is active or inactive, recurring, in remission, or resolved (as of the last update of the Condition)."
			Value:			CodeableConcept

			Element:		WhenClinicallyRecognized
			Concept:		TBD
			Description:	"The time at which a condition or condition was first identified in a healthcare context."
			Value:			date

			Element:		PresentOnAdmission
			Concept:		LNC#89251-3 "Condition present on admission"
			Description:	"If the problem or condition existed before the current episode of care."
			Value:			CodeableConcept from YesNoUnknownVS

			Element:		Severity
			Concept:		MTH#C0392364
			Description:	"Degree of harshness or extent of a symptom, disorder, or condition."
			Value: 			CodeableConcept

			Element:		Criticality
			Concept:		MTH#C3858539 "Criticality"
			Description:	"The potential clinical harm associated with a condition. When the worst case result is assessed to have a life-threatening or organ system threatening potential, it is considered to be of high criticality."
			Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/allergy-intolerance-criticality

			Element:		StageInformation
			Concept:		MTH#C0699749
			Description:	"The relative advancement in the course of a disease. The StageCode is the summary stage or stage group. StageDetail optionally contains the full staging information."
			0..1			StageSummary
			0..1			StageDetail
			
					Element:		StageSummary
					Concept:		TBD
					Description:	"A code representing the current stage of a disease."
					Value:			CodeableConcept

					Element:		StageDetail
					Concept:		TBD
					Description:	"The full staging information"
					Value:			ref(Observation)

			Element:		AlleviatingFactor
			Concept:		LNC#55258-8
			Description:	"Activities that reduce the severity of the pathology"
			Value:			CodeableConcept

			Element:		ExacerbatingFactor
			Concept:		LNC#55258-8
			Description:	"Activities that increase the severity of the pathology"
			Value:			CodeableConcept

			Element:		Onset
			Concept:		LNC#85585-8
			Description:	"The beginning or first appearance of a mental or physical disorder."
			Value:			dateTime or Age or TimePeriod or Range or string
			
			Element:		Abatement
			Concept:		LNC#88878-4
			Description:	"The end, remission or resolution."
			Value:			dateTime or Age or boolean or TimePeriod or Range or string
				
EntryElement:	ClinicalNote
Based on:		SimpleNonLaboratoryObservation
Concept:		MTH#C0747978 "Progress Note"
Description:	"An entry concerning a patient where the result is a narrative text. While all findings have a CommentOrDescription field, the clinical note should put the narrative in the DataValue field, since this is the first place to look for a result that is a narrative."
				Code is MTH#C0747978 "Progress Note"
				DataValue value is type string
0..0			ReferenceRange
1..1			Patient
//1..1			CommentOrDescription // put into DataValue


EntryElement:	BodyStructurePresent
Based on:		Condition
Description:	"A body structure such as wound or tumor, observed to be present in a patient. The body structure is a condition that persists over time. The Code represents the body structure itself (the morphology), while the BodySiteCode is the location of that structure. This corresponds to FHIR R4, where the BodyStructure resource has morphology (corresponding to Code) and location (corresponding to BodySite.BodySiteCode. For example, the Code could be blunt force injury (SCT 3821009) and location left knee."
				Code from BodyStructureVS if covered
0..0			Focus
0..0			ReferenceRange
