Grammar:		DataElement 5.0
Namespace:		shr.core
Description:	"The SHR Core domain contains definitions for a variety of general-purpose elements that are used widely in SHR. These include definitions for coding, expressions of time, quantities, addresses, names, and more."
Uses:			entity, shr.base, finding

Path:			FHIR = http://hl7.org/fhir/ValueSet
// CodeSystem:     CC = http://www.nationsonline.org/oneworld/country_code_list
CodeSystem:     LNC = http://loinc.org
CodeSystem:     SCT = http://snomed.info/sct
CodeSystem:     MTH = http://ncimeta.nci.nih.gov
CodeSystem:		NCI = https://evs.nci.nih.gov/ftp1/CDISC/SDTM/
CodeSystem:     UCUM = http://unitsofmeasure.org 


//------------ Complex Types aligned with FHIR ---------------

Element:		Quantity
Description:	"A quantity with units, whose value may be bounded from above or below, as defined in FHIR"
Value:			0..1 decimal
0..1			Comparator
0..1			Units

		Element:		Comparator
		Value:			code from http://hl7.org/fhir/ValueSet/quantity-comparator

		Element:		Units
		Concept:		TBD
		Description:	"Code for the unit of measure of the quantity."
		Value:			Coding from http://hl7.org/fhir/ValueSet/ucum-units or Coding from CurrencyVS

Element:		SimpleQuantity
Based on:		Quantity
Description:	"A quantity where the comparator is not used, as defined in FHIR"
0..0			Comparator

Element:		IntegerQuantity
Based on:		Quantity
Description:	"A Quantity that is an integer."
				Units.Coding is UCUM#1

Element:		Age
Based on:		Quantity
Concept:		MTH#C0001779
Description:	"How long something has existed in time."
				Units with Coding from http://hl7.org/fhir/ValueSet/units-of-time

Element:		Distance
Based on:		Quantity
Concept:		MTH#C0012751
Description:	"The measure of space separating two objects or points."
				Units with Coding from UnitsOfLengthVS
				
Element:		Duration
Based on:		Quantity
Concept:		MTH#C0449238
Description:	"The length of time that something continues."
				Units with Coding from TimeUnitOfMeasureVS

Element:		Money
Based on:		Quantity
Concept:		TBD
Description:	"Representation of an amount of currency or monetary value."
				Units with Coding from CurrencyVS


//------------- Complex data types in FHIR 3.0 ---------------

Element:		Attachment
Based on:		EmbeddedContent
Concept:		TBD
Description:	"A file that contains audio, video, image, or similar content."
0..1			BinaryData
0..1			ContentType
0..1			ResourceLocation
0..1			ResourceSize
0..1			Hash
0..1			Title
0..1			CreationTime

	Element:		BinaryData
	Concept:		TBD
	Description:	"The data itself."
	Value:			base64Binary

	Element:		ContentType
	Concept:		TBD
	Description:	"Mime type of the content, with charset etc."
	Value:			code

	Element:		ResourceLocation
	Concept:		TBD
	Description:	"URI where data can be found."
	Value:			uri

	Element:		ResourceSize
	Concept:		TBD
	Description:	"Number of bytes of content in the resource (if url provided)"
	Value:			unsignedInt

	Element:		Hash
	Concept:		TBD
	Description:	"A hash code of the data (sha-1, base64ed)"
	Value:			base64Binary
	
	Element:   	 	CreationTime  
	Concept:        MTH#C3669169
	Description:    "The point in time when the information was recorded in the system of record."
	Value:          dateTime  // we can map to instant from dateTime


//---- Coding departs from CIMI to align with FHIR

Element:		Coding
Concept:		MTH#C0805701
Description:	"Coding of a concept, drawn from a controlled vocabulary. Includes the vocabulary and version, if applicable. May include a display text, and a descriptor expressing the intended interpretation of the code."
Value:			0..1 code
0..1			CodeSystem
0..1 			CodeSystemVersion
0..1			DisplayText
//0..*			CodingQualifier
	
/*
 TODO: Suggest changing FHIR's Coding.userSelected to Coding.qualifier 
	Element:		CodingQualifier
	Concept:		TBD
	Description:	"A description of the purpose or origin of the code that assists in understanding the code."
	Value:			code from CodingQualifierVS
*/

	Element:		CodeSystem
	Concept:		TBD
	Description:	"A formal terminology system."
	Value:			uri

	Element:		CodeSystemVersion
	Concept:		TBD
	Description:	"The version of the vocabulary being used, if applicable."
	Value:			string // Should be id type in FHIR, but it is a string (no issue recorded yet)
	
Element:		CodeableConcept
Concept:		TBD
Description:	"A set of codes drawn from different coding systems, representing the same concept."
0..*			Coding
0..1			DisplayText

Element:		Range
Concept:		TBD
Description:	"An interval defined by a quantitative upper and/or lower bound. One of the two bounds must be specified, and the lower bound must be less than the upper bound. When Quantities are specified, the units of measure must be the same."
0..1			LowerBound value is type SimpleQuantity
0..1			UpperBound value is type SimpleQuantity

	Element:		LowerBound
	Concept:		TBD
	Description:	"The lower limit on a range"
	Value:			Quantity  // or decimal or unsignedInt or integer 

	Element:		UpperBound
	Concept:		TBD
	Description:	"The upper limit on a quantitative value."
	Value:			Quantity  // or decimal or unsignedInt or integer 

Element:		Ratio
Concept:		MTH#C0456603
Description:	"A unit of measurement for the quotient of the amount of one entity to another."
1..1			Numerator
1..1			Denominator

	Element:		Numerator
	Concept:		MTH#C2825219
	Description:	"The dividend of a fraction."
	Value:			Quantity

	Element:		Denominator
	Concept:		MTH#C2825218
	Description:	"The divisor of a fraction."
	Value:			Quantity


Element:		TimePeriod
Concept:		MTH#C1948053
Description:	"A period of time defined by a start and end time, date, or year. If the start element is missing, the start of the period is not known. If the end element is missing, it means that the period is ongoing, or the start may be in the past, and the end date in the future, which means that period is expected/planned to end at the specified time. The end value includes any matching date/time. For example, the period 2011-05-23 to 2011-05-27 includes all the times from the start of the 23rd May through to the end of the 27th of May."
0..1			TimePeriodStart
0..1			TimePeriodEnd  // lack of end time indicates the period was continuing at the time the entry was created

	Element: 		TimePeriodStart    // synonym "EffectiveDate"
	Concept: 		MTH#C1301880
	Description: 	"The time at which something is to take effect, start, or did start. Boundary is considered inclusive."
	Value:			dateTime   // TODO: would like to have date or dateTime but that wouldn't be FHIR-compatible

	Element:		TimePeriodEnd
	Concept:		MTH#C1522314
	Description:	"The time at which something is to end or did end. Boundary is considered inclusive."
	Value:			dateTime   // TODO: would like to have date or dateTime but that wouldn't be FHIR-compatible


Element: 	Timing
Concept:	TBD
Description: "A timing schedule that specifies an event that may occur multiple times. Timing offers a choice of multiple OccurrenceTime (used is used to specify specific times), or recurrence patterns."
0..*		OccurrenceTime
0..1		TimingCode
0..1		EventDuration
0..1		RecurrencePattern
0..1		RecurrenceRange

	Element:		TimingCode
	Concept:		TBD
	Description: 	"A code for the timing schedule. Some codes such as BID are ubiquitous, but many institutions define their own additional codes. If a code is provided, the code is understood to be a complete statement of whatever is specified in the structured timing data, and either the code or the data may be used to interpret the Timing, with the exception that .repeat.bounds still applies over the code (and is not contained in the code)."
	Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/timing-abbreviation if covered
	
	Element:		EventDuration
	Description:	"The length of the recurring event."
	Value:			DurationRange
	
	Element:	RecurrencePattern
	Concept:	TBD
	Description: "A set of rules that describe when a recurring event is scheduled."
	0..1		RecurrenceInterval
	0..*		DayOfWeek
	0..*		TimeOfDay
	0..*		DailyLifeEvent
	0..1		LifeEventOffset
	0..1		CountPerInterval

		Element:		RecurrenceInterval
		Concept:		TBD
		Description:	"The period of time after which the pattern repeats, for example, each day. To specify an event should take place every other Monday, the recurrence interval should be two weeks, and DayOfWeek should be Monday."
		Value:			Duration
		
		Element:		DayOfWeek
		Concept:		TBD
		Description:	"A day of the week that the pattern should take place."
		Value:			code from http://hl7.org/fhir/ValueSet/days-of-week
		
		Element:		TimeOfDay
		Concept:		TBD
		Description:	"Time of day the event should take place on the designated day(s). TimeOfDay should only be specified if the RecurrenceInterval and/or DayOfWeek establishes the day when the event should take place."
		Value:			time
		
		Element:		DailyLifeEvent
		Concept:		TBD
		Description:	"A quotidian landmark, such as rising, mealtime, or bedtime, when an event should take place."
		Value:			code from http://hl7.org/fhir/ValueSet/event-timing

		Element:		LifeEventOffset
		Concept:		TBD
		Description:	"A time in minutes before or after a given life event, for example, 30 minutes before a meal. Whether this means before or after is carried by the life event code."
		Value:			unsignedInt
		
		Element:		CountPerInterval
		Concept:		TBD
		Description:	"How many times the event should take place during one recurrence interval, for example, to specify 3-4 times per day, the CountPerInterval should be 3 to 4."
		0..1			MinCount
		0..1			MaxCount
		
				Element:	MinCount
				Description: "Lower bound on a count."
				Value:		integer   // FHIR - should be unsignedInt	
				
				Element:	MaxCount
				Description: "Upper bound on a count."
				Value:		integer // FHIR - should be unsignedInt		
		
	Element: 		RecurrenceRange
	Concept:		TBD
	Description:	"The start and end of the overall recurrence pattern in terms of dates/times or in terms of number of repeats. Could also be an event, such as when all doses are taken."
	Value:			TimePeriod or NumberOfRepeats
			
		Element:		NumberOfRepeats
		Concept:		TBD
		Description:	"How many times the action should be repeated."
		Value:			positiveInt

	
//------------ Complex Data Types not in FHIR ----------------

Element:		Count
Concept:		MTH#C0750480
Description:	"The number of items (0 or more), as an integer."
Value:			unsignedInt

Element:		EmbeddedContent
Concept:		TBD
Description:	"Abstract class defining the common metadata of all types of encapsulated data, such as images."

Element:		ParsableContent
Based on:		EmbeddedContent
Concept:		TBD
Description:	"A string that follows a formal syntax and can be analyzed and broken into meaningful parts."
Value:			string
1..1			Formalism

	Element:		Formalism
	Concept:		TBD
	Description:	"The system of formal syntax or interpretation associated with parsable content."
	Value:			CodeableConcept

/*  No can do! Can't restrict "value is type" to a primitive
Element:		UnsignedIntegerRange
Description:	"A range of non-negative integers. One of the two bounds must be present, and the lower bound must be less than or equal to the upper bound."
0..1			LowerBound value is type unsignedInt
0..1			UpperBound value is type unsignedInt
*/

Element:		DurationRange
Description:	"A range of durations."
0..1			LowerBound value is type Duration
0..1			UpperBound value is type Duration
	
Element:		Statistic
Based on: 		Quantity
Concept:		MTH#C2828391
Description:	"A quantity that represents a statistic, e.g. maximum, minimum, mean, median, etc."
1..1			StatisticType

		Element:		StatisticType
		Concept:		TBD
		Description:	"The type of statistic that is represented by the value."
		Value:			CodeableConcept from StatisticTypeVS

Element: 		Priority
Concept:		MTH#C0549179
Description:	"An indication of the importance of an action."
Value:			positiveInt or CodeableConcept

Element:		Percentage
Based on:		SimpleQuantity
Concept:		MTH#C0439165
Description:	"A percentage value where 100.0 represents 100%."
				Units.Coding is UCUM#%

Element:		Likelihood
Concept:		MTH#C0033204
Description:	"A measure of the expectation of the occurrence of a particular event, as a percentage."
Value:			positiveInt   // 0-100 do not allow zero, since this will create an implicit modifier

Element:		QualitativeLikelihood
Concept:		TBD
Description:	"A qualitative (subjective) likelihood."
Value:			CodeableConcept from QualitativeLikelihoodVS

Element:		GeneralizedLikelihood
Concept:		TBD
Description:	"Quantitative or qualitative measure of likelihood."
Value:			Likelihood or QualitativeLikelihood

Element:		Certainty
Concept:		TBD
Description:	"The degree of confidence in a conclusion or assertion."
Value:			CodeableConcept from QualitativeValueScaleVS



Element:		Length
Based on:		EvaluationComponent
Concept:		MTH#C1444754
Description:	"The measurement or linear extent of something from end to end; the greatest dimensions of a body."
Value:			Quantity with units UCUM#TBD

Element:		Width
Based on:		EvaluationComponent
Concept:		MTH#C0487742
Description:	"The measurement or extent of something from side to side."
Value:			Quantity with units UCUM#TBD

Element:		Depth
Based on:		EvaluationComponent
Concept:		MTH#C0205125
Description:	"The extent downward or inward; the perpendicular measurement from the surface downward to determine deepness."
Value:			Quantity with units UCUM#TBD

Element:		Volume
Based on:		EvaluationComponent
Concept:		MTH#C0449468
Description:	"The amount of three dimensional space occupied by an object or the capacity of a space or container."
Value:			Quantity with units UCUM#TBD

Element:		Area
Based on:		EvaluationComponent
Concept:		MTH#C0205146
Description:	"The extent of a 2-dimensional surface enclosed within a boundary."
Value:			Quantity with units UCUM#TBD

Element:		Circumference
Based on:		EvaluationComponent
Concept:		MTH#C0332520
Description:	"The length of such a boundary line of a figure, area, or object."

Element:		ClockDirection
Based on:		EvaluationComponent
Concept:		LNC#72294-2
Description:	"A direction indicated by an angle relative to 12 o'clock."
Value:			CodeableConcept from ClockDirectionVS


// --------------- Times and Time TimePeriods ----------------



Element:		QualitativeDateTime
Concept:		TBD
Description:	"A point in time, described qualitatively."
Value:			CodeableConcept from QualitativeDateTimeVS





// -----------  Age --------------------------

Element:		AgeRange
Concept:		TBD
Description:	"A quantitative range of ages. One of the two ages must be specified."
// Since Lower and Upper bounds in Range are based on SimpleQuantity and Age is based on Quantity, there is no way to make AgeRange a subtype of Range
0..1			UpperBound value is type Age
0..1			LowerBound value is type Age


//------------ Generalized ways to refer to when an event happened

Element:		GeneralizedDateTime
Concept:		TBD
Description:	"A point in time, specified qualitatively or quantitatively."
Value:			dateTime or TimePeriod or QualitativeDateTime

Element:		GeneralizedAge
Concept:		TBD
Description:	"Qualitative or quantitative, exact or inexact description of age."
Value:			Age or AgeRange

Element:		GeneralizedTemporalContext
Concept:		TBD
Description:	"A generalized indicator of a dateTime or an age when an event happened."
Value:			GeneralizedDateTime or GeneralizedAge

//-------------- Duration and Frequency  -----------------

Element:		SemiquantDuration
Concept:		TBD
Description:	"The duration of an event, described semi-quantitatively."
Value:			CodeableConcept from SemiquantitativeDurationVS

Element:		GeneralizedDuration
Concept:		TBD
Description:	"The duration of an event, qualitatively or quantitatively."
Value:			Duration or SemiquantDuration

Element:		Frequency   // TODO: should be a ratio, but the problem is that ratio uses Quantity in numerator and denominator
Based on:		Ratio
Concept:		MTH#C0376249
Description:	"How many occurrences of an event per unit of time."
				Numerator.Quantity with units UCUM#1
				Denominator.Quantity.Units with Coding from http://hl7.org/fhir/ValueSet/units-of-time

Element:		SemiquantFrequency
Concept:		TBD
Description:	"The frequency of an event, described semi-quantitatively."
Value:			CodeableConcept from SemiquantitativeFrequencyVS

Element:		QualitativeFrequency
Concept:		TBD
Description:	"The frequency of an event, described qualitatively."
Value:			CodeableConcept from QualitativeFrequencyVS

Element:		GeneralizedFrequency
Concept:		TBD
Description:	"The frequency of an event, qualitatively or quantitatively."
Value:			Frequency or SemiquantFrequency or QualitativeFrequency


//------------- Interpretations of Time -------------------

Element:		EffectiveDate
Concept:		MTH#C1301880
Description:	"The date when something is to take effect."
Value:			date

Element:		EffectiveTimePeriod
Based on:		TimePeriod
Concept:		MTH#C2985763
Description:	"The date and time span for which something is active, valid, or in force."

Element:		ReceivedTime
Concept:		MTH#C2735124	
Description:	"Time received by accepting facility or unit."
Value:			dateTime

Element:		OccurrenceTimeOrPeriod
Concept:		TBD
Description:	"The point in time or span of time in which something happens."
Value:			date or dateTime or TimePeriod

Element:		NonOccurrenceTimeOrPeriod
Concept:		TBD
Description:	"The point in time or span of time in which something did not happen."
Value:			date or dateTime or TimePeriod

Element:		OccurrenceTime
Based on:		OccurrenceTimeOrPeriod
Concept:		TBD
Description:	"The point in time in which something happens."
Value:			dateTime

/* Not used
Element:		OccurrenceDate
Based on:		OccurrenceTimeOrPeriod
Concept:		TBD
Description:	"The date when something happens."
Value:			date
*/

Element:		OccurrencePeriod
Based on:		OccurrenceTimeOrPeriod
Concept:		TBD
Description:	"The point in time or span of time in which something happens."
Value:			TimePeriod

Element:		OccurrenceDuration
Concept:		TBD
Description:	"The length of time in which something happens."
Value:			Duration

	
Element:		BodyPosition
Concept:		MTH#C1262869
Description:	"The position or physical attitude of the body."
Value:			CodeableConcept from BodyPositionVS

Element:		Details
Concept: 		MTH#C0947611
Description:	"An text note containing additional details, explanation, description, comment, or summarization. Details can discuss, support, explain changes to, or dispute information."
Value:			string  // change to language-text

Element:		DisplayText
Concept:		MTH#C1548311
Description:	"A string meant for reading by a person, for example, accompanying a code."
Value:			string

Element:		Version
Concept:		MTH#C0333052
Description:	"A string identifying the particular of form of something (such as a code system or software product) that is different in some way from another form of the same thing."
Value:			id

Element:		Reason
Concept:		MTH#C0566251
Description:	"The justification for an action or non-action, conclusion, opinion, etc."
Value:			string or CodeableConcept or ref(Topic)

Element:		Title
Concept:		TBD
Description:	"A distinguishing word or group of words naming an item."
Value:			string

Element:		Category
Concept:		TBD
Description:	"A class or division of people or things having particular shared characteristics"
Value:			CodeableConcept

Element:		Definitional
Concept:		MTH#C1704788
Description:	"An indicator that the item is a description of a thing, not a thing that actually exists. For example, a group of people between ages 30 and 40 with Type II diabetes can be defined, without existing as a set of particular people."
Value:			boolean 