Grammar:		DataElement 5.0
Namespace:		shr.finding
Description:	"The SHR Finding domain contains basic definitions used to capture subjective and objective information about the subject. Things observed about the subject can include demographic facts, history, subjective and objective observations, assessments, and judgments, excluding actual or potential interventions, and range from simple answered questions to vital signs and laboratory results."
Uses:			shr.core, shr.base, shr.action, shr.entity, shr.procedure, shr.medication, shr.condition, shr.device

CodeSystem:     SCT = http://snomed.info/sct

Element:		FindingContext
Based on:		Context
Concept:		SCT#410514004
Description:	"The base class for representing the ontological status of a finding, e.g., present, absent, goal, risk, expectation, etc. This class aligns with the SNOMED Situation with Explicit Context."
1..1			ContextCode

	Element:		ContextCode
	Concept:		TBD
	Description:	"A code indicating the particular type of context. For example, in the PresenceContext, the code might represent known present, suspected present, or probably not present."
	Value:			CodeableConcept

	Element:		PresenceContext
	Based on:		FindingContext
	Concept:		SCT#410515003
	Description:	"PresenceContext indicates the finding in question exists or is present to some level of certainty. For example, if the finding involves a myocardial infarction, the presence context implies that cardiac arrest has (or may have) taken place. Note that the name Presence is used rather than Present to prevent confusion with the temporal meaning of present, i.e., the present time."
					ContextCode from PresenceContextVS
	0..1			Onset
	0..1			Abatement
	
	Element:		ReportedContext
	Based on:		PresenceContext
	Concept:		TBD
	Description:	"A simplified PresenceContext used to indicate an evaluation has been made. For example, measurement of blood pressure that has been made simply exists (although the value can be present or absent, accurate or inaccurate). The ReportedContext indicates the information presented stands on its own as presented. It can also apply to a clinical notes."
					ContextCode is SCT#36692007 "Known"  // not exactly right -- from its descendants, known means either known absent, known possible, known present, etc. We really want a code that just says this is known or observed.
	0..0			Onset
	0..0			Abatement

	Element:		AbsenceContext
	Based on:		FindingContext
	Concept:		TBD
	Description:	"Indicates the finding in question is either known absent (ruled out), not suspected, or unknown."
					ContextCode from AbsenceContextVS
			
	Element:		AtRiskContext
	Based on:		FindingContext
	Concept:		SCT#410519009
	Description:	"At risk indicates the finding should be interpreted as a future possibility or expectation."
					ContextCode from AtRiskContextVS

	Element:		ExpectationContext
	Based on:		FindingContext
	Concept:		SCT#410517006
	Description:	"A context indicating the finding is an expectation, prognosis, or likely outcome."
					ContextCode from ExpectationContextVS				

	Element:		GoalContext
	Based on:		FindingContext
	Concept:		SCT#410518001
	Description:	"A hypothetical or future finding that represents an objective or goal."
					ContextCode from GoalContextVS
				

Element: 		FindingTopic
Based on:		Topic
Concept:		TBD
Description:	"Base class - independent of context - for all kinds of determinations: questions/answers, conditions, observations, allergies, and other findings. The subject of a finding can be the entire patient, or an entity such as a location body structure, intervention, or condition. Things observed about the subject can include social and behavioral factors, subjective and objective observations, and assessments."
0..1			Subject   // TODO: change to 1..1?  IF COMMENTED OUT, then in FHIR types would be defaulted to UN-PROFILED values
1..1			FindingCode
0..1			FocusCodeableConcept
0..1			FocusReference
0..1			FindingMethod
0..1			FindingStatus
0..*			Evidence

	Element:		FindingCode
	Concept:		MTH#C1706203
	Description:	"A code that represents what the finding concerns, for example, the subject's height, blood pressure, disease status, wound dimensions, diabetes risk, etc. Although named FindingCode, in different contexts the same attribute might be more naturally referred to as a property, observable, or test code. In assertions and finding classes (findings without an explicit question), the observation code defaults to the concept code, so, for example, the finding code for an AdverseReaction is SCT#281647001 (Adverse reaction)."
	Value:			CodeableConcept 
	
	Element:		FocusCodeableConcept
	Concept:		TBD
	Description:	"The specific observed aspect of the Subject under consideration, potentially a specific condition, intervention, activity, body structure, or environmental factor. For use when the observation is not the Subject as a whole. An example would be an observation related to the Subject's bipolar disorder."
	Value:			CodeableConcept
	
	Element:		FocusReference
	Concept:		TBD
	Description:	"The specific observed aspect of the Subject under consideration, potentially a specific condition, intervention, activity, body structure, or environmental factor. For use when the observation is not the Subject as a whole. An example would be an observation related to the Subject's bipolar disorder."
	Value:			ref(Topic)
		
	Element:		FindingMethod
	Concept:		TBD
	Description:	"The technique used to create the finding, for example, the specific imaging technical, lab test code, or assessment vehicle."
	Value:			CodeableConcept should be from http://loinc.org

	Element:		FindingStatus
	Concept:		TBD
	Description:	"Indicates whether the finding is preliminary, amended, final, etc.."
	Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/observation-status

	Element:		Evidence
	Concept:		TBD
	Description:	"A symptom, observation, or other item, for example, a radiology report, that serves as evidence for the current assessment."
	Value:			CodeableConcept or ref(Topic)

EntryElement:	ClinicalNote
Based on:		FindingTopic
Concept:		MTH#C0747978 "Progress Note"
Description:	"An entry concerning a patient where the result is a narrative text. Can be related to a specific Focus, such as a condition; and evidence and interpretation from FindingTopic."
Value:			string
1..1			ReportedContext	

Abstract Element: AssertionTopic
Based on:		FindingTopic
Concept:		TBD
Description:	"The base topic for conditions, allergies, adverse events, etc. These are things that are asserted to exist or not. The Value is interpreted in the context of the class; for an AdverseSensitivityToSubstance, the value is the substance, for a Condition, the Value represents the type of condition found."
Value:			0..1  CodeableConcept
		
Element:		EvaluationTopic
Based on:		FindingTopic
Concept:		MTH#C1554188
Description:	"The base class, independent of context for evaluations (measurements, tests, or questions) and a value containing the result (answer). The subject of a finding can be the entire patient, or an entity such as a location body structure, intervention, or condition. Things observed about the subject can include social and behavioral factors, subjective and objective observations, and assessments."
Value:			0..1 (Quantity or CodeableConcept or string or boolean or Range or Ratio or Attachment or time or dateTime or TimePeriod or IntegerQuantity)
0..*			Category from http://hl7.org/fhir/ValueSet/observation-category if covered
0..1			BodySite  // TODO: Change to code to align with FHIR??
0..1			ref(Device)
0..1			ref(Specimen)
0..1			DeltaFlag
0..1			Details
0..1			Interpretation
0..*			Precondition
0..*			ReferenceRange  // applies to a quantitative measurement only
0..* 			EvaluationComponent
1..1			Members

		Element:		RelevantTime
		Concept:		TBD
		Description:	"The time or time period that the finding addresses. The clinically relevant time is not necessarily when the information is gathered or when a test is carried out, but for example, when a specimen was collected, or the time period referred to by the question. Use a TimePeriod for a measurement or specimen collection continued over a significant period of time (e.g. 24 hour Urine Sodium)."
		Value:			dateTime or TimePeriod or Timing
		
		Element:		DeltaFlag
		Concept:		MTH#C1705241
		Description:	"Indicator of significant change (delta) from the last or previous measurement."
		Value:			CodeableConcept from DeltaFlagVS
		
		Element:		Interpretation
		Concept:		MTH#C0420833
		Description:	"A clinical interpretation of a finding."
		Value:			CodeableConcept from http://hl7.org/fhir/ValueSet/observation-interpretation
		
		Element:		Precondition
		Concept:		TBD
		Description:	"A description of the conditions or context of an observation, for example, under sedation, fasting or post-exercise. Body position and body site are also qualifiers, but handled separately. A qualifier cannot modify the measurement type; for example, a fasting blood sugar is still a blood sugar."
		Value:			CodeableConcept
		
		Element:		ReferenceRange
		Concept:		MTH#C0883335
		Description:	"The usual or acceptable range for a test result."
		Value:			Range   // TODO: align this with FHIR
		0..1			Type from http://hl7.org/fhir/ValueSet/referencerange-meaning if covered
		0..1			ApplicableSubpopulation
		0..1			ApplicableAgeRange
		
				Element:	ApplicableSubpopulation
				Concept:	MTH#C0039309 "Target Population"
				Description:	"Codes to indicate the target population this reference range applies to. For example, a reference range may be based on the normal population or a particular sex or race."
				Value: 		CodeableConcept from http://hl7.org/fhir/ValueSet/referencerange-appliesto if covered
		
				Element:	ApplicableAgeRange
				Concept:	TBD
				Description:	"The age at which this reference range is applicable. This is a neonatal age (e.g. number of weeks at term) if the meaning says so."  // FHIR: how exactly does one indicate a neonatal or prenatal age?
				Value:		Range

		
		Abstract Element:	EvaluationComponent
		Concept:		TBD
		Description:	"A simplified, non-separable evaluation consisting of a finding code, value (or value absent reason), reference range, and interpretation. The subject of the observation component is the same as in the parent observation."
		Value:			0..1 (Quantity or CodeableConcept or string or Range or Ratio or Attachment or time or dateTime or TimePeriod or IntegerQuantity)
		0..1			ExceptionValue
		1..1			FindingCode
		0..1			Interpretation
		0..*			ReferenceRange

		
		Element:		Members
		Concept:		TBD
		Description:	"Members represent the elements of a group of a related but independent observations. Examples are the measurements that compose a complete blood count (CBC), or the elements of a pathology report. Each member is an independent observation, but the grouping reflects a composite lab order, shared specimen, or a single report author. Typically the Category and Reason are not given for individual findings that are part of the panel, but rather given at the level of the panel itself."
		// Lloyd McKenzie said "has-member is for things like panels. For example, a CBC (complete blood count) would have members capturing white blood cell count, red blood cell count, hemoglobin, etc.  See https://chat.fhir.org/#narrow/search/cbc "
		Value:			0..* ref(EvaluationTopic)

		
Element:		EvaluationResultReportedContext
Based on:		ReportedContext
Description:	"Context for an evaluation result, when the evaluation has been carried out, and a result is reported."
0..1			ExceptionValue
0..1			RelevantTime   // ClinicallyRelevantTime isn't a good name when it comes to employment and other life history events
1..1			FindingStatus  // constrain from 0..1 to 1..1 to match FHIR Observation
0..1			EvaluationProcedurePerformed


		Element:		EvaluationProcedurePerformed
		Concept:		TBD
		Description:	"The evaluation procedure that is the source of the evaluation result. The FindingMethod is the general method used to produce the result, while the EvaluationProcedure is a pointer to the actual instance of the procedure."
		Value:			ref(ProcedureTopic)   // can't do ProcedurePerformed because subclasses are based on Topic -- this is a pain, and we need multiple inheritance!


		
//----------------- Instantiations ------------------

EntryElement:	EvaluationGoal
Based on:		EvaluationTopic
Concept:		TBD
Description:	"Represents an evaluation result that is in the prospective (future) context, taken as a goal or objective, for example, systolic blood pressure below 140."
1..1			GoalContext

	
EntryElement:	EvaluationResult
Based on:		EvaluationTopic
Concept:		TBD
Description:	"Represents the result of evaluations (measurements, tests, or questions) that have been performed. EvaluationResult has a value representing the result (answer), or an ExceptionValue indicating why the value is not present. The subject of a finding can be the entire patient, or an entity such as a location body structure, intervention, or condition. Things observed about the subject can include social and behavioral factors, subjective and objective observations, and assessments."
1..1			EvaluationResultReportedContext
				Members value is type ref(EvaluationResult)

		Element:		ExceptionValue
		Concept:		TBD
		Description:	"Reason that a value associated with a test or other finding is missing."
		Value:			CodeableConcept from ExceptionValueVS

		
EntryElement:	LaboratoryTestResult
Based on:		EvaluationResult
Concept:		TBD
Description:	"Measurement resulting from a laboratory analysis."
0..*			DiagnosticService
0..1			EvaluationProcedurePerformed value is type LaboratoryProcedureTopic  // LaboratoryProcedurePerformed is not subclass a ProcedurePerformed
		
		Element:		DiagnosticService
		Concept:		TBD
		Description:	"A code that classifies the clinical discipline, department or diagnostic service that created the report (e.g. cardiology, biochemistry, hematology, MRI). This is used for searching, sorting and display purposes."
		Value:			CodeableConcept from DiagnosticServiceVS if covered

EntryElement:	QuestionAnswer
Based on:		EvaluationResult
Concept:		TBD
Description:	"A simplified evaluation (independent of context) consisting of a question-answer pair. The question is identified by the FindingCode, and the answer (if given) is in Value. If the answer is missing, an ExceptionValue must be provided. For a series of related questions, the EvaluationResult.Members can have the supporting questions."
0..0			ref(Device)
0..0			BodySite
0..0			ReferenceRange  // applies to a quantitative measurement only
1..1			Members value is type QuestionAnswer




// Used in Careplan and elsewhere
Element:		RelatedFinding
Concept:		TBD
Description:	"Findings associated with this item." 
Value:			ref(FindingTopic)


EntryElement:	DiseaseProgression
Based on:		EvaluationResult
Concept:		MTH#C0421176 "Progression"
Description:	"A finding related to the current trend of a disease. This concept is most often used for chronic and incurable diseases where the status and trendline of the disease is an important determinant of therapy and prognosis. The specific disorder being evaluated must be cited in the Focus_Reference or Focus_CodeableConcept as a reference to a Condition."
Value:			CodeableConcept from ProgressionVS
				FindingCode is MTH#C0421176 "Progression"
				FocusCodeableConcept should be from ConditionVS
				FocusReference value is type ref(Condition)
0..*			Evidence from ProgressionEvidenceTypeVS


Abstract Element:	BodyStructureTopic
Based on:		EvaluationTopic
Concept:		MTH#C1268086
Description:	"Presence (or absence) of a distinct anatomical or pathological morphological feature or organizational pattern, acquired or innate. Examples include tissue types, tumors, and wounds."
Value:			CodeableConcept from BodySiteVS
				FindingCode is MTH#C1268086
0..1			Morphology

	Element:		Morphology
	Concept:		TBD
	Description:	"The kind of structure being represented. This can define both normal and abnormal morphologies."
	Value:			CodeableConcept

	
EntryElement:	BodyStructurePresent
Based on:		BodyStructureTopic
Concept:		TBD
Description:	"Presence of a distinct anatomical or pathological morphological feature or organizational pattern, acquired or innate. Examples include tissue types, tumors, and wounds. Body structures are continuants that allow observations of the same body structure to be related to be tracked over time."
1..1			PresenceContext
		

/*
Element:		ReportStatus
Concept:		TBD
Description:	"The status of the report associated with this panel."
Value:			code from http://hl7.org/fhir/ValueSet/diagnostic-report-status
*/
