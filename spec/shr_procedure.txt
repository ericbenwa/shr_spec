Grammar:		DataElement 5.0
Namespace:		shr.core

CodeSystem:		OBSCAT = http://hl7.org/fhir/observation-category


EntryElement:	Procedure
Based on:		ActionPerformed
Description:	"A procedure that has been performed."
				SubjectOfRecord is type SubjectOfRecord-3
1..1			Code from http://hl7.org/fhir/us/core/ValueSet/us-core-procedure-code if covered
0..*			BodySite
0..1			PartOf value is type ref(Procedure)
0..1			Category  // this is a constraint on the cardinality of Action.Category
0..*			Annotation
0..1			ReasonCode
0..1			ReasonReference
0..0			Method	// Procedure doesn't have Method		
0..*			TreatmentIntent
				Participation.OnBehalfOf value is type ref(Organization)
				// TODO: StatusReason
				// Status from http://hl7.org/fhir/ValueSet/event-status
				// Conflict V2 V3: Cannot override value set constraint from http://hl7.org/fhir/ValueSet/procedure-status to http://hl7.org/fhir/ValueSet/event-status
//				Participation.Participant.EntityOrRole is type ref(Practitioner)
				Participation.Participant is type Participant-4
				RelatedRequest value is type ref(ProcedureRequest)
0..1			ref(Location)
0..1			Outcome
0..*			MaterialUsed

	Element:		MaterialUsed
	Description:	"Items used during procedure"
	Value:			ref(Device) or ref(Medication) or ref(Substance)

    Element:        TreatmentIntent
    Concept:        SCT#395077000 "Treatment intent (situation)"  // TODO: Needs a new LOINC number"
    Description:	"The intended result from a given treatment.  Examples include curative, palliative, and supportive."
    Value:          CodeableConcept from TreatmentIntentVS


EntryElement:	ProcedureRequest
Based on:		ActionRequested
Description:	"A request for a procedure to be performed. May be a proposal or an order."
				SubjectOfRecord is type SubjectOfRecord-3
				PriorityCode // must be from http://hl7.org/fhir/ValueSet/request-priority 
				// DSTU 2 change (different required value sets in v2 and v3)
				Status // from http://hl7.org/fhir/ValueSet/request-status  
				// DSTU 2 change(different required value sets in v2 and v3)
0..1			Author is type Author-5 // this is the intersection between DSTU 2 and STU 3. DSTU 2 allows Organization, and STU 3 allows Patient and RelatedPerson. Both allow Practitioner and Device.
1..1			Type from http://hl7.org/fhir/us/core/ValueSet/us-core-procedure-code if covered
0..*			BodySite
0..1			PartOf value is type ref(Procedure)
0..1			Category  // this is a constraint on the cardinality of Action.Category
0..*			Annotation
0..1			ReasonCode
0..1			Method
				RequestIntent from http://hl7.org/fhir/ValueSet/request-intent
//0..*			InputFinding  -- covered by Reason
//0..*			Indication
0..1			ref(Location)
0..1			Recipient is type Recipient-1  // TODO: why is Recipient equated with Performer?



//---------- Specialized Types of Procedure Topics ----------------

EntryElement:	ImagingProcedure
Based on:		Procedure
Concept:		TBD
Description:	"Experimental class for an imaging procedure. This class is still incomplete at this time."
0..*			ImagingSubstance

	Element:		ImagingSubstance
	Concept:		TBD
	Description:	"Substance used for this imaging procedure such as a contrast agent."
	Value:			CodeableConcept


EntryElement:	LaboratoryProcedure
Based on:		Procedure
Concept:		MTH#C0456984
Description:	"A procedure performed on a collected specimen such as a blood panel or a biopsy."
1..1			Code from http://hl7.org/fhir/ValueSet/observation-codes // ??
				Category is OBSCAT#laboratory
0..1			ref(Specimen)
//0..1 			ref(Device)   // constraint from 0..*


EntryElement:	SurgicalProcedure
Based on:		Procedure
Concept:		TBD
Description:	"A surgical action, independent of action context."
0..*			DirectSite
0..*			IndirectSite
0..*			SurgicalApproach

		Element:		DirectSite
		Description:	"The site where the procedure is performed."
		Value:			BodySite

		Element:		IndirectSite	
		Description:	"The indirect site for this procedure."
		Value:			BodySite

		Element:		SurgicalApproach
		Description:	"The technique used to reach the site of the procedure. Approaches may be through the skin or mucous membrane, through an orifice or external."
		Value:			CodeableConcept


EntryElement:   RadiationProcedure
Based on:       Procedure
Description:    "A radiation oncology procedure. If the treatment is part of a larger course of treatment, the PartOf attribute should indicate that."
    	    	Code from RadiationProcedureVS 
0..1    		RadiationDosePerFraction
0..1    		RadiationFractionsDelivered
0..1    		TotalRadiationDoseDelivered

Element:        RadiationDosePerFraction
Concept:        TBD#TBD  // TODO: Needs new LOINC and/or SNOMED codes
Description:    "The total number of treatment sessions (fractions) administered during a course of radiation therapy therapy. A fraction is a portion of the total radiation dose, delivered as a series of treatments that make up the full course of radiotherapy. (source: LOINC)"
Value:          Ratio

Element:        RadiationFractionsDelivered
Concept:        LNC#21959-2 "Number of radiation treatment"
Description:    "The total number of treatment sessions (fractions) administered during a course of radiation therapy therapy. A fraction is a portion of the total radiation dose, delivered as a series of treatments that make up the full course of radiotherapy. (source: LOINC)"
Value:          Quantity with units UCUM#1

Element:        TotalRadiationDoseDelivered
Concept:        SCT#445461008 "Total radiation dose delivered (observable entity)"
Description:    "The total amount of radiation dose delivered for the course of therapy. (source: SNOMED, ASTRO)"
Value:          Quantity with units UCUM#Gy


EntryElement:   DiagnosticImaging
Based on:       ImagingProcedure
Description:    "Diagnostic imaging procedure performed."
                Code from DiagnosticImagingVS

/*
EntryElement:	SubstanceAbuseTreatment
Based on:		ProcedurePerformed
Description:	"The treatment program used to address a substance abuse problem."
				Code from SubstanceAbuseTreatmentTypeVS
*/